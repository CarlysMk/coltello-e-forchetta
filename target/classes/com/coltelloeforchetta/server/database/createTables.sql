CREATE TABLE IF NOT EXISTS UtentiRegistrati(Username varchar(50) PRIMARY KEY, NomeUtente varchar(30) NOT NULL, CognomeUtente varchar(30) NOT NULL, DataNascita Date, Domicilio varchar(200) NOT NULL, Password varchar(20) NOT NULL, Ruolo boolean NOT NULL);
CREATE TABLE IF NOT EXISTS Ristoranti(IDRistorante SERIAL PRIMARY KEY, NomeRistorante varchar(50) NOT NULL, Nazione varchar(100) NOT NULL, Citta varchar(200) NOT NULL, Indirizzo varchar(200) NOT NULL, Latitudine float NOT NULL, Longitudine float NOT NULL, FasciaPrezzo float NOT NULL, Delivery boolean NOT NULL, PrenotazioneOnline boolean NOT NULL, UsernameProprietario varchar(50) NOT NULL REFERENCES UtentiRegistrati(Username) ON UPDATE CASCADE ON DELETE CASCADE, CHECK (Latitudine >= -90 AND Latitudine <= 90 AND Longitudine >= -180 AND Longitudine <= 180));
CREATE TABLE IF NOT EXISTS CategorieCucina(NomeCategoria varchar(20) PRIMARY KEY);
CREATE TABLE Recensioni(UsernameCliente varchar(50) NOT NULL REFERENCES UtentiRegistrati(Username) ON UPDATE CASCADE ON DELETE NO ACTION, IDRistorante int NOT NULL REFERENCES Ristoranti(IDRistorante) ON UPDATE CASCADE ON DELETE CASCADE, Stelle int NOT NULL, Commento varchar(300), Risposta varchar(300), CHECK (Stelle >= 1 AND Stelle <= 5), PRIMARY KEY (UsernameCliente, IDRistorante));
CREATE TABLE SpecializzazioniRistorante(Categoria varchar(20) NOT NULL REFERENCES CategoriaCucina(NomeCategoria) ON UPDATE CASCADE ON DELETE CASCADE, IDRistorante int NOT NULL REFERENCES Ristoranti(IDRistorante) ON UPDATE CASCADE ON DELETE CASCADE);
CREATE TABLE RistorantiPreferiti(UsernameCliente varchar(50) NOT NULL REFERENCES UtentiRegistrati(Username) ON UPDATE CASCADE ON DELETE CASCADE, IDRistorante int NOT NULL REFERENCES Ristoranti(IDRistorante) ON UPDATE CASCADE ON DELETE CASCADE)